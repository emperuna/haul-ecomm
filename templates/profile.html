{% extends 'base.html' %}

{% block content %}
<div class="manage-account-container">
    <button class="sidebar-toggle" onclick="toggleSidebar()">â˜°</button>

    <!-- Sidebar Section -->
    <div class="sidebar" id="sidebar">
        <h2>My Account</h2>
        <ul>
            <li><a href="/profile">Profile</a></li>
            <li><a href="/payment">Payment Options</a></li>
            <li><a href="/change-password">Change Password</a></li>
            <li><a href="/privacy">Privacy Settings</a></li>
            <li><a href="/notification">Notification Settings</a></li>
        </ul>
    </div>

    <!-- Edit Profile Section -->
    <div class="edit-profile">
        <h2>Edit Profile</h2>
        <form id="edit-profile-form" method="POST" action="/profile" enctype="multipart/form-data">
            <div class="form-group">
                <label for="first-name">First Name</label>
                <input type="text" id="first-name" name="first_name" value="{{ current_user.first_name }}" placeholder="First Name">
            </div>
            <div class="form-group">
                <label for="middle-name">Middle Name</label>
                <input type="text" id="middle-name" name="middle_name" value="{{ current_user.middle_name }}" placeholder="Middle Name">
            </div>
            <div class="form-group">
                <label for="last-name">Last Name</label>
                <input type="text" id="last-name" name="last_name" value="{{ current_user.last_name }}" placeholder="Last Name">
            </div>
            <div class="form-group">
                <label for="suffix">Suffix</label>
                <input type="text" id="suffix" name="suffix" value="{{ current_user.suffix }}" placeholder="Suffix (e.g., Jr., Sr.)">
            </div>

            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" value="{{ current_user.username }}" placeholder="Username" readonly>
            </div>

            <div class="form-group">
                <div class="profile-pic-container">
                    <img 
                        id="profile-pic-preview" 
                        src="{{ url_for('static', filename=user.profile_picture) }}" 
                        alt="Profile Picture" 
                        class="profile-pic"
                    >
                    <label for="profile-pic" class="select-image-button">Select Image</label>
                    <input type="file" id="profile-pic" name="profile_pic" accept="image/*" style="display: none;" onchange="previewProfilePic(event)">
                </div>
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <div class="email-container">
                    <input type="email" id="email" name="email" value="{{ current_user.email }}" placeholder="Email" readonly>
                </div>
            </div>

            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone" value="{{ current_user.phone }}" placeholder="Phone Number">
            </div>

            <div class="form-group">
                <label for="birthdate">Birth Date</label>
                <input type="date" id="birthdate" name="birthdate" value="{{ current_user.birthdate }}">
            </div>

            <div class="form-group">
                <label for="address">Address</label>
                <textarea id="address" name="address" placeholder="Enter your address">{{ current_user.address }}</textarea>
            </div>

            <button type="submit">Save Changes</button>
        </form>
    </div>
</div>

<script>
    function previewProfilePic(event) {
        const preview = document.getElementById('profile-pic-preview');
        preview.src = URL.createObjectURL(event.target.files[0]);
        preview.onload = () => URL.revokeObjectURL(preview.src);
    }
</script>
{% endblock %}
