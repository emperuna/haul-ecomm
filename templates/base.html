<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}HAUL | Website{% endblock %}</title>

  <!-- Stylesheet -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/seller-registration.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/cart.css') }}">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Bootstrap -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script> 

  <!-- Styles -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    /* Header Styles */
    .header {
      background-color: #003449;
      padding: 10px 20px;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
      font-size: 13px;
      margin-bottom: 15px;
    }

    .top-left {
      display: flex;
      gap: 15px;
    }

    .top-right {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .user-section {
      display: flex;
      align-items: center;
      gap: 8px;
      border-left: 1px solid #666;
      margin-left: 15px;
      padding-left: 15px;
      position: relative;
    }

    .user-section:hover .dropdown-menu {
      display: block;
      opacity: 1; /* Ensure dropdown is visible */
    }

    .dropdown-menu {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 3px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      width: 180px;
      margin-top: 5px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }

    .dropdown-menu a {
      padding: 10px 15px;
      display: block;
      color: #333;
      text-decoration: none;
      font-size: 14px;
    }

    .dropdown-menu a:hover {
      background-color: #f5f5f5;
      color:#333;
    }

    .profile-pic {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      overflow: hidden;
    }

    .profile-pic img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .main-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 10px 20px;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      color: #666;
      text-decoration: none;
      margin-right: 40px;
    }

    .search-container {
      flex: 1;
      max-width: 840px;
      position: relative;
    }

    .search-box {
      display: flex;
      background: white;
      border-radius: 4px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .search-input {
      flex: 1;
      padding: 12px 15px;
      border: none;
      outline: none;
      font-size: 14px;
      width: 100%;
    }

    .search-button {
      background: #9cb2bf;
      color: white;
      border: none;
      padding: 0 25px;
      cursor: pointer;
    }

    .search-button:focus {
      outline: none;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

    .cart-icon {
      color: #9cb2bf;
      font-size: 24px;
      position: relative;
      margin-left: 40px;
    }

    .cart-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: red;
      color: white;
      border-radius: 50%;
      padding: 1px 6px;
      font-size: 12px;
    }

    a {
      color: #666;
      text-decoration: none;
    }

    .top-bar a {
      color: #9cb2bf;
    }

    a:hover {
      opacity: 0.8;
    }

  /* Mobile view adjustments */
  @media screen and (max-width: 768px) {
      .top-bar {
          flex-direction: column;
          align-items: flex-start;
      }

      .main-nav {
          flex-direction: column;
          align-items: flex-start;
      }

      .search-container {
          margin-top: 15px;
          width: 100%;
      }

      .search-box {
          width: 100%;
      }

      .cart-icon {
          margin-left: 0;
          margin-top: 15px;
      }

      .logo {
          margin-right: 0;
          margin-bottom: 15px;
      }

      .top-left a, .top-right a {
          margin-right: 10px;
      }
  }

  .nav-icons {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-left: 30px;
  }

  .nav-icon {
    position: relative;
    color: #9cb2bf;
    font-size: 24px;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .nav-icon:hover {
    color: #ffffff;
  }

  .badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: #ff523b;
    color: white;
    border-radius: 50%;
    padding: 1px 6px;
    font-size: 12px;
    min-width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  @media screen and (max-width: 768px) {
    .nav-icons {
      margin-left: 0;
      margin-top: 15px;
    }
  }

    .flash-messages {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        max-width: 400px;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .alert {
        padding: 1rem;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        margin: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        animation: slideIn 0.3s ease-out;
        max-width: 100%;
        background: #fff;
        border-left: 4px solid;
    }

    .alert-success {
        border-left-color: #10B981;
        color: #065F46;
        background-color: #ECFDF5;
    }

    .alert-danger {
        border-left-color: #EF4444;
        color: #991B1B;
        background-color: #FEF2F2;
    }

    .alert-warning {
        border-left-color: #F59E0B;
        color: #92400E;
        background-color: #FFFBEB;
    }

    .alert-info {
        border-left-color: #3B82F6;
        color: #1E40AF;
        background-color: #EFF6FF;
    }

    .btn-close {
        background: none;
        border: none;
        color: currentColor;
        padding: 0;
        cursor: pointer;
        opacity: 0.5;
        transition: opacity 0.3s ease;
    }

    .btn-close:hover {
        opacity: 1;
    }

    .alert-content {
        margin-right: 1rem;
        font-size: 0.95rem;
    }

    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes fadeOut {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
  </style>
</head>

<body>
  <div class="flash-messages">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}" role="alert">
                    <div class="alert-content">{{ message }}</div>
                    <button type="button" class="btn-close" onclick="closeAlert(this.parentElement)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
  </div>

<!-- Header -->
  <header class="header">
    <div class="top-bar">
        <div class="top-left">
          {% if current_user.is_authenticated %}
          {% if current_user.role == 'seller' %}
            <a href="{{ url_for('seller') }}">Seller Centre</a>
            <a href="{{ url_for('seller_registration') }}">Start Selling</a>
          {% else %}
          <a href="{{ url_for('seller_centre') }}">Seller Centre</a>
          <a href="{{ url_for('seller_registration') }}">Start Selling</a>
          {% endif %}
      {% else %}
          <a href="{{ url_for('login') }}">Seller Centre</a>
          <a href="{{ url_for('login') }}">Start Selling</a>
      {% endif %}
        </div>
        <div class="top-right">
            <!-- <a href="#">
                <i class="fas fa-bell"></i>
                Notifications
            </a> -->
            <a href="#">
                <i class="fas fa-question-circle"></i>
                Help
            </a>
            <!-- <a href="#">
                <i class="fas fa-globe"></i>
                English
            </a> -->
            <div class="user-section">
                {% if current_user.is_authenticated %}
                  <a href="{{ url_for('profile') }}">{{ current_user.username }}</a>
                  <!-- <div class="profile-pic">
                    <img src="/api/placeholder/20/20" alt="Profile">
                  </div>     -->
                  <div class="dropdown-menu">
                    <a href="{{ url_for('profile' )}}">My Account</a>
                    <a href="{{ url_for('order_history' )}}">My Purchase</a>
                    <a href="{{ url_for('rate_order' )}}">Ratings</a>
                    <a href="{{ url_for('logout' )}}">Logout</a>
                  </div>
                {% else %}
                  <a href="{{ url_for('register') }}">Sign Up</a>
                  <a href="{{ url_for('login') }}">Login</a>
                {% endif %}
          </div>
        </div>
    </div>
    <nav class="main-nav">
        <a href="{{ url_for('home') }}" class="logo">
          <img src="{{ url_for('static', filename='images/haul-logo-header.png') }}" alt="haul." class="logo-img">
        </a>
        <div class="search-container">
          <form method="GET" action="{{ url_for('products') }}"> <!-- Ensure the action points to your search handler -->
              <div class="search-box">
                  <input 
                      type="text" 
                      name="search" 
                      id="product-search"
                      class="search-input" 
                      placeholder="Search in HAUL." 
                      value="{{ request.args.get('search', '') }}" 
                  />
                  <button type="submit" class="search-button">
                      <i class="fas fa-search"></i> <!-- Font Awesome Search Icon -->
                  </button>
              </div>
          </form>
        </div>
        <div class="nav-icons">
            <a href="{{ url_for('cart') }}" class="nav-icon">
                <i class="fas fa-shopping-cart"></i>
                <span class="badge" {% if cart_count == 0 %}style="display: none;"{% endif %}>{{ cart_count }}</span>
            </a>
            <a href="{{ url_for('wishlist') }}" class="nav-icon">
                <i class="fas fa-heart"></i>
                <span class="badge" {% if wishlist_count == 0 %}style="display: none;"{% endif %}>{{ wishlist_count }}</span>
            </a>
        </div>
    </nav>
</header>


  {% block content %}{% endblock %}


  <!-- Footer -->
  <div class="footer">
    <div class="container">
      <div class="row">
        <div class="footer-col-1">
          <h3>Download Our App</h3>
          <p>Download App for Android and iOS mobile phone.</p>
          <div class="app-logo">
            <img src="{{ url_for('static', filename='images/play-store.png') }}" alt="Play Store">
            <img src="{{ url_for('static', filename='images/app-store.png') }}" alt="App Store">
          </div>
        </div>
        <div class="footer-col-2">
          <img src="{{ url_for('static', filename='images/haul-logo-footer.png') }}" alt="Logo">
          <p>Our Purpose Is To Provide Affordable Goods To Those In Need.</p>
        </div>
        <div class="footer-col-3">
          <h3>Useful Links</h3>
          <ul>
            <li><a href="{{ url_for('contact') }}">Contacts</a></li>
            <li><a href="#">Blog Post</a></li>
            <li><a href="#">Return Policy</a></li>
            <li><a href="{{ url_for('about') }}">About Us</a></li>
          </ul>
        </div>
        <div class="footer-col-4">
          <h3>Follow Us</h3>
          <ul>
            <li>Facebook</li>
            <li>Twitter</li>
            <li>Instagram</li>
            <li>YouTube</li>
          </ul>
        </div>
      </div>
      <hr>
      <p class="copyright">Copyright 2024 - BSCS 2A</p>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="{{ url_for('static', filename='js/script.js') }}"></script>

  <!-- JavaScript -->
  <script>
    var MenuItems = document.getElementById("MenuItems");
    if (MenuItems) {
      MenuItems.style.maxHeight = "0px";
      function menutoggle() {
        MenuItems.style.maxHeight = MenuItems.style.maxHeight === "0px" ? "200px" : "0px";
      }
    }

    // Function to close individual alerts
    function closeAlert(alert) {
        alert.style.animation = 'fadeOut 0.3s ease-out forwards';
        setTimeout(() => {
            alert.remove();
        }, 300);
    }

    // Auto-dismiss alerts after 5 seconds
    document.addEventListener('DOMContentLoaded', function() {
        const alerts = document.querySelectorAll('.alert');
        alerts.forEach(alert => {
            setTimeout(() => {
                if (alert && alert.parentElement) {
                    closeAlert(alert);
                }
            }, 5000);
        });
    });

    // Prevent multiple alerts with the same message
    function preventDuplicateAlerts() {
        const alerts = document.querySelectorAll('.alert');
        const messages = new Set();
        
        alerts.forEach(alert => {
            const message = alert.querySelector('.alert-content').textContent;
            if (messages.has(message)) {
                alert.remove();
            } else {
                messages.add(message);
            }
        });
    }

    // Run on page load
    preventDuplicateAlerts();
  </script>

</body>
</html>